 s inputcsv=".#.......#...........#.........,..##.......#.#.#.....##...#....,.......#..#.....#...#..........,...#..........###...#........##,#.#..#.#.##.#........#.#.....#.,#..#....#..#....#..............,#..#........#..................,..#.#...#.#...#....#.#.#..#....,..............#..#.............,.##....#...................#...,........#..........#......#...#,.##..#..#...##..........#...#..,.#...#....#.........#...#.....#,.#........##............#.#....,...........#..............##...,.#..#......#..#..............#.,..#.#.#...........#........#...,..###..........#....#.#......#.,.......#...##..........#.......,........#...#..................,....#....#..#.......#........#.,.......##.#......#.....#...##..,..#.#........................#.,.#.....#.##..............#.#...,..#.#...#.#..#....#....#.......,.#....##.....#....#........#...,..#...........#.##....#...#....,..#.##...#....#.#.....##...#...,.......#...####...#...#.......#,.#...#.........................,.......................#.......,.....#.#.........#..........#.#,#.........#............###..#..,.....#.#.............###.......,...#..#........#.#.......#.....,...................#....#......,...#..#...#............#..##...,...#.....#....#.......##......#,.....#....#...##..#..#...#...#.,..........#...........#.#.#....,..#.......#...#.....#......#...,.........#.......##......#..#.#,..#.....#..#.###...#.#......#..,#....#...#..#...#.....#........,..#......#..#.......#.#.....#..,#......#...#......#.....##.#...,........##.......#.......#.....,.#.#...............#...........,..............#...#.#....#.....,....#......#.#..#......#.......,...##....#....#...#............,.#...............#...........#.,.#.#...#.#.....#.....#...#.#...,...##...........#.....#..#...#.,.#.#...##.#.#......#......#....,.##.....#.......##....#.#.#....,.......#...........#....#....#.,....#...........#......#.####..,......#....#...#...##.......#..,......................#.#####..,..#...#.#...#..#..#......#.....,....#........##.......##....#..,#.#......##.........##.#..#...#,.#.#....#...#..#...#...##....#.,.....##...#....#....#.#........,......#..#....#.#...#..........,.........#...................#.,............#.###....#.#.......,...#.#.....#......#....#.#..#..,..............#..#.#.#.#.......,#..##...................##.....,..#.......#..#.........##..#...,.........##...#......#........#,..#.........#........##.###.#..,...........#.#....#.....###....,..#....##.#..#.##....#.....##..,..#.....#.##..................#,#....#.........................,..............#..#...#.#.......,......#..#.#.##....#..........#,..#.........#.####.....#.......,......#..#.#..........#...#....,......#.................#..#.#.,.....#..........#..............,....#.....#............#....##.,.....#.....#........#..........,............#.....#...#........,........#....#.#...............,#.....#.........#......#..#.#..,...#..#......#......#.......#..,.....#......#.#....#..#...#...#,......................#..##....,.............#.........###....#,#..............#.#..........##.,...#.#.................##......,...........#.#.....#...........,.........#.................#.#.,........#........#...#..##...#.,........#......##.......###....,..............#.#.#............,.#.....###...##.#......#.....#.,.............#......#.#.#...#.#,..#.........#.......#.....#....,......#........#...##......#...,.##..........##......#.#.....#.,..#.##....#....#...............,......#...#..#.....#.....#...#.,.......##..##..#............##.,..............#...##........#..,#....#................#..#.....,........#.......#.#.#...#......,......#.......#..............#.,#.#..#...#........#....#..####.,..#........#...........#.....#.,.##...........................#,.............#...........#.....,.#.....#.#...#.........#.......,..........#...#....#....#......,.#..#........##....#...........,.......###......##...#.........,..........#.#.#..#.#....#......,........##..#.........#....#...,........#.#......#.#...#.#..#..,....#....................#.##..,##....#..#...........#.....#.#.,...#..............##...##..#.#.,......#.##.#.......#..#...#....,....#..#..##.....#.....#.#....#,.......#....##.##..............,#..##....#.....#.#.............,..................#......#..#..,..#......#...#..#.......#...#..,...........#....#.#.....#......,#..#...##.........###..#......#,.......#......................#,#.......#....................#.,..#..#..........#..#..#....#...,.##..#..#.....#.#..##..........,#..###.......#..##..#...#..#.#.,.....##......###.....#.#.##...#,..............#...#....#.#.....,#...........#..................,..............#....#..##..#..#.,.........#.............#.......,.#.#....#....#...............##,.##.##.#.....###.....#.........,....#..............##......#...,....#........##................,....#.....#....#....##....##...,.#........#......#......#......,....#..........#...............,##..........#......#.....#.....,........#.#..#.#..#.....##.....,..##......#.#.......#.#..#.....,.#.......#......#...........#..,..#.#..#.#..................#..,...#...#...#...##......#.......,.#...##....#...#...#...#.......,.......#.#.......#.............,.#.##.#.....#...........#.##.#.,.#.##.#........#...##..........,.#.....#.....#....#..#.........,...##.............##...........,.#........##.....#.......#...#.,...........#..#..##........##..,.....#..#......................,..#.......#....................,.....#......#....#....#.......#,........#..#.#.....#......#....,..........#..#.....#......#....,..........#####.....#........#.,........#..#...#.#....#......#.,.........#...#....#.#..........,......#....##..........#...#...,#..............###.#.#.........,.#.#............##......#.#..#.,......#........................,...#..#......#.......#....#...#,.......#....##.....#.#......##.,...........#..........#..#.....,...........#..#.....###......#.,.......#....#..##......#.......,.........#.#.#.......#..#...#..,.......#.......##.....##...#...,..............#....#.....#.....,...#....#.....#.#..........##..,###.........#.............#....,...##......#.#........#....#..#,#....###.......#...#.#......##.,....#...##.......#......#.....#,.....#......#..................,#........##....#....#.#........,........#.......###...#........,........#..#.......###.........,..............#......#..#......,#......#.....#....#.#..........,.#......##.#.#.....#...#.#....#,.##...........#..#.##.....#....,.....#.....................#...,.#..#...#...##.#...#...........,.......#.......##..#.#..#......,.......##.....#.....#..........,.................#.............,#........#..#.......##.........,#...#..###.#..#....#.#.###.....,..#.......#.......#.......#....,..............#............##..,.#...#..#...##.........#....#..,#...........#...#..............,.......#.....#......#..#.....#.,..........#......#.............,##.........###..##.#....#..#.#.,..............###..............,#..##.............##.....#.....,....##...................#..#..,....#.....#..............#..#.#,........#........##...#.....##.,#...........#.##..........##...,#......##.....#...............#,..##..#....#.................#.,#.......##.....................,...............#.##..##......#.,..#.##..#.#....#.......##......,......##....#............##....,.#..#..##.....#.##....#........,#.........#..........#...#....#,...#.......#.............#.#.#.,..##............#...##........#,.......#.#.#........#..........,.....#.............#.....#.....,.........#.........#.........#.,#.....#....#.......#...........,.........#....#.............#.#,.##..#.......#...#......#......,....#....#....#........#....#..,............#.......#..#......#,.#............#.##........##...,..#...##...#....#...#.#...#..#.,#...#..........#..##.........#.,..#.........................#.#,...........#.........#..#.##...,.#..................#..#.......,......#......#...........#..#..,...##.....#.....#..#.......#...,.........#.#.......#......#....,...........#................#..,.....#...#..#............##....,.#.......#..#....#..........#..,#.....#..#.....#..##.......##..,...#.......#...#....#...#.#..##,...#...##......#....#....#.....,.......###.#..#.......#......#.,........#.#...#..#..#...#....#.,....#.........##.#.....#.......,....#.........#..##........#...,..#...........#......#....#.##.,.....................#.........,...................##......#..#,......#.#.....##..##..........#,..#.##........#.#.#..........#.,.#.......#...##.#....#....#....,#.#......#..#..#.......#.......,.............#........#.......#,....#...#.....#........#...#...,..#..............##..#.........,..#.................#..#...##..,....#..#...#...................,......#.........##.#..#..#...##,........#..#....#.......#.#.##.,.#...#...........#..........#..,##.....#...#............##...#.,.##.....#...#..................,.#.......####.#..##.##.#......#,.............#...#..#..#.......,...#.##.........#.#....#.......,...........##...##....#....##..,........#......#...#...........,...........#..#...#....#.##....,..##....#..........#....#...#..,#....#.#.#.......#.#...........,......#............##..........,#.#.###..#....#.......#...#....,.#......##..#..#.#.........#..#,..#.........#........#....#....,......##.#.......##....#..#..##,.............#...#............#,......#......#...#.#.#.##.#....,#.#...#.##.....#..............#,..........#.............##.##..,#......#....#...#.#.#.#..#....#,........#........#...#.#......#,.....#...........#.............,...........#....#..........#...,....####...#..##....#.#........,.#......#...#..#...........#...,#......###..#.##.###...........,..#...........#.........#....#.,................#.#....#..#.##.,...................#......#....,....#.#.....#.......#...###.##.,.#........#.#....#...#..#...#..,....#..###.................#..#,.....#.#..#........#......#..#.,....#.....#...............#...#,............##.#.........#..#..,.......#..#..##.#.#...##.......,..#..........##..#..#........#.,..............#..#...#.........,......#.#....#........##.......,.#.....##....#..#...#.......##.,..............#.##.............,#..#..#...##....##.#.....##.#..,..#...###..#.........##........,........##......#.....#..###...,.....#......##.###.............,....#.....#.#..#.#..#..........,....#..#.......#...........#...,.#.............#..#......##....,..#.#......#.#.................,.......#.#.#............#..#...,......###....##............#..#,.........#....#......#.........,..........#...............#..#."
 
 s inputlist = $LFS(inputcsv,",")
 s inputsize = $LL(inputlist)
 
 s width=$L($LG(inputlist,1))
 
 s product=1
 
 s product=$$slopecheck(3,1) 
 w product,!
 
 s product=product * $$slopecheck(1,1)
 s product=product * $$slopecheck(5,1)
 s product=product * $$slopecheck(7,1)
 s product=product * $$slopecheck(1,2)
 w product,!

slopecheck(slopex,slopey)
 s x=1+slopex
 s y=1+slopey
 
 s count=0
 
 for i=y:slopey:inputsize
 {
 	 //modulus was not handling the edge case of x=1 for some reason. ...i mean... the reason being values starting at 1 rather than 0
	 //but just adding 1 failed to fix it properly. 
	 //presumably this is cleaner than adding a bunch of offsets to calculate 0-based just so i get to use modulus
	 if (x>width)
	 {
		 s x=x-width
	 }
	 
	 if $E($LG(inputlist,i),x,x)="#"
	 {
		 s count=count+1
	 }
	 s x=x+slopex
 }
 
 return count
